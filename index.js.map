{"version":3,"file":"index.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loading = document.querySelector('.loading');\nconst target = document.querySelector('.js-guard');\n\nlet page = 1;\nlet queryInput = '';\n\nconst lightbox = new SimpleLightbox('.item-link', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst options = {\n  root: null,\n  rootMargin: '200px',\n  threshold: 1.0,\n};\n\nconst callback = entries => {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      page++;\n      getImagesOnSearch(queryInput)\n        .then(res => {\n          gallery.insertAdjacentHTML('beforeend', createMarkUp(res.hits));\n          lightbox.refresh();\n        })\n        .catch(error => {\n          console.log(error);\n        });\n    }\n  });\n};\n\nconst observer = new IntersectionObserver(callback, options);\n\nform.addEventListener('submit', onFormSubmit);\n\nfunction onFormSubmit(e) {\n  e.preventDefault();\n\n  queryInput = e.currentTarget.elements.query.value;\n\n  if (queryInput === '') {\n    iziToast.error({\n      message:\n        'Please enter a value!',\n    });\n  } else {\n    getImagesOnSearch(queryInput)\n      .then(res => {\n        if (res.hits.length === 0) {\n          iziToast.error({\n            message:\n              'Sorry, there are no images matching your search query. Please try again!',\n          });\n        } else {\n          loading.classList.add('is-hidden');\n          gallery.insertAdjacentHTML('beforeend', createMarkUp(res.hits));\n          observer.observe(target);\n          lightbox.refresh();\n        }\n      })\n      .catch(error => {\n        loading.classList.add('is-hidden');\n        console.log(error)\n      });\n  }\n}\n\nfunction getImagesOnSearch(query) {\n  const params = new URLSearchParams({\n    key: '29734383-6ec437d7a0c5df52cef54a0f9',\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page\n  });\n\n  loading.classList.remove('is-hidden');\n  // gallery.innerHTML = '';\n\n  return fetch(`https://pixabay.com/api/?${params}`).then(res => {\n    if (!res.ok) {\n      throw new Error(res.status);\n    }\n    return res.json();\n  });\n}\n\nfunction createMarkUp(arr) {\n  return arr\n    .map(\n      el =>\n        `<li class=\"gallery-item\">\n            <a class=\"item-link\" href=\"${el.largeImageURL}\">\n              <img\n                class=\"item-image\"\n                src=\"${el.webformatURL}\"\n                alt=\"${el.tags}\"\n              >\n            </a>\n            <div class=\"item-stats_container\">\n              <p class=\"item-stats\"><span>Likes</span>${el.likes}</p>\n              <p class=\"item-stats\"><span>Views</span>${el.views}</p>\n              <p class=\"item-stats\"><span>Comments</span>${el.comments}</p>\n              <p class=\"item-stats\"><span>Downloads</span>${el.downloads}</p>\n            </div>\n          </li>`\n    )\n    .join('');\n}"],"names":["form","gallery","loading","target","page","queryInput","lightbox","SimpleLightbox","options","callback","entries","entry","getImagesOnSearch","res","createMarkUp","error","observer","onFormSubmit","e","iziToast","query","params","arr","el"],"mappings":"6vBAMA,MAAMA,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,WAAW,EAEjD,IAAIC,EAAO,EACPC,EAAa,GAEjB,MAAMC,EAAW,IAAIC,EAAe,aAAc,CAChD,SAAU,GACV,aAAc,MACd,aAAc,GAChB,CAAC,EAEKC,EAAU,CACd,KAAM,KACN,WAAY,QACZ,UAAW,CACb,EAEMC,EAAWC,GAAW,CAC1BA,EAAQ,QAAQC,GAAS,CACnBA,EAAM,iBACRP,IACAQ,EAAkBP,CAAU,EACzB,KAAKQ,GAAO,CACXZ,EAAQ,mBAAmB,YAAaa,EAAaD,EAAI,IAAI,CAAC,EAC9DP,EAAS,QAAO,CAC1B,CAAS,EACA,MAAMS,GAAS,CACd,QAAQ,IAAIA,CAAK,CAC3B,CAAS,EAET,CAAG,CACH,EAEMC,EAAW,IAAI,qBAAqBP,EAAUD,CAAO,EAE3DR,EAAK,iBAAiB,SAAUiB,CAAY,EAE5C,SAASA,EAAaC,EAAG,CACvBA,EAAE,eAAc,EAEhBb,EAAaa,EAAE,cAAc,SAAS,MAAM,MAExCb,IAAe,GACjBc,EAAS,MAAM,CACb,QACE,uBACR,CAAK,EAEDP,EAAkBP,CAAU,EACzB,KAAKQ,GAAO,CACPA,EAAI,KAAK,SAAW,EACtBM,EAAS,MAAM,CACb,QACE,0EACd,CAAW,GAEDjB,EAAQ,UAAU,IAAI,WAAW,EACjCD,EAAQ,mBAAmB,YAAaa,EAAaD,EAAI,IAAI,CAAC,EAC9DG,EAAS,QAAQb,CAAM,EACvBG,EAAS,QAAO,EAE1B,CAAO,EACA,MAAMS,GAAS,CACdb,EAAQ,UAAU,IAAI,WAAW,EACjC,QAAQ,IAAIa,CAAK,CACzB,CAAO,CAEP,CAEA,SAASH,EAAkBQ,EAAO,CAChC,MAAMC,EAAS,IAAI,gBAAgB,CACjC,IAAK,qCACL,EAAGD,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAhB,CACJ,CAAG,EAED,OAAAF,EAAQ,UAAU,OAAO,WAAW,EAG7B,MAAM,4BAA4BmB,CAAM,EAAE,EAAE,KAAKR,GAAO,CAC7D,GAAI,CAACA,EAAI,GACP,MAAM,IAAI,MAAMA,EAAI,MAAM,EAE5B,OAAOA,EAAI,MACf,CAAG,CACH,CAEA,SAASC,EAAaQ,EAAK,CACzB,OAAOA,EACJ,IACCC,GACE;AAAA,yCACiCA,EAAG,aAAa;AAAA;AAAA;AAAA,uBAGlCA,EAAG,YAAY;AAAA,uBACfA,EAAG,IAAI;AAAA;AAAA;AAAA;AAAA,wDAI0BA,EAAG,KAAK;AAAA,wDACRA,EAAG,KAAK;AAAA,2DACLA,EAAG,QAAQ;AAAA,4DACVA,EAAG,SAAS;AAAA;AAAA,gBAGnE,EACA,KAAK,EAAE,CACZ"}