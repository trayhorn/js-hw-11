{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.ts","../src/main.js"],"sourcesContent":["export default function createMarkUp(arr) {\n  return arr\n    .map(\n      el =>\n        `<li class=\"gallery-item\">\n          <a class=\"item-link\" href=\"${el.largeImageURL}\">\n            <img\n              class=\"item-image\"\n              src=\"${el.webformatURL}\"\n              alt=\"${el.tags}\"\n            >\n          </a>\n          <div class=\"item-stats_container\">\n            <p class=\"item-stats\"><span>Likes</span>${el.likes}</p>\n            <p class=\"item-stats\"><span>Views</span>${el.views}</p>\n            <p class=\"item-stats\"><span>Comments</span>${el.comments}</p>\n            <p class=\"item-stats\"><span>Downloads</span>${el.downloads}</p>\n          </div>\n        </li>`\n    )\n    .join('');\n}\n","type SearchParams = {\n  key: string;\n  q: string;\n  image_type: string;\n  orientation: string;\n  safesearch: boolean;\n  page: number;\n}\n\n\nexport default function getImagesOnSearch(query: string, page: number) {\n  const params = new URLSearchParams ({\n    key: '29734383-6ec437d7a0c5df52cef54a0f9',\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    page: page.toString(),\n  });\n\n  return fetch(`https://pixabay.com/api/?${params}`).then(res => {\n    if (!res.ok) {\n      throw new Error(res.status.toString());\n    }\n    return res.json();\n  });\n}","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport createMarkUp from './js/render-functions';\nimport getImagesOnSearch from './js/pixabay-api';\n\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loading = document.querySelector('.loading');\nconst target = document.querySelector('.js-guard');\n\nlet currentPage = 1;\nlet queryInput = '';\n\nconst lightbox = new SimpleLightbox('.item-link', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\n// Infinite scroll\n\nconst options = {\n  root: null,\n  rootMargin: '200px',\n  threshold: 1.0,\n};\n\nconst onLoad = entries => {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      currentPage++;\n      getImagesOnSearch(queryInput, currentPage)\n        .then(({ hits }) => {\n          loading.classList.remove('is-hidden');\n          gallery.insertAdjacentHTML('beforeend', createMarkUp(hits));\n          lightbox.refresh();\n        })\n        .catch(error => {\n          console.log(error);\n        })\n        .finally(() => {\n          loading.classList.add('is-hidden');\n        });\n    }\n  });\n};\n\nconst observer = new IntersectionObserver(onLoad, options);\n\n// Main part\n\nform.addEventListener('submit', onFormSubmit);\n\nfunction onFormSubmit(e) {\n  e.preventDefault();\n  queryInput = e.currentTarget.elements.query.value;\n\n  if (queryInput === '') {\n    iziToast.error({\n      message:\n        'Please enter a value!',\n    });\n    return;\n  }\n  getImagesOnSearch(queryInput, currentPage)\n    .then(({ hits }) => {\n      if (hits.length === 0) {\n        iziToast.error({\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n        });\n      } else {\n        loading.classList.remove('is-hidden');\n        gallery.insertAdjacentHTML('beforeend', createMarkUp(hits));\n        observer.observe(target);\n        lightbox.refresh();\n      }\n    })\n    .catch(error => {\n      console.log(error);\n    })\n    .finally(() => {\n      loading.classList.add('is-hidden');\n    });\n}"],"names":["createMarkUp","arr","el","getImagesOnSearch","query","page","params","res","form","gallery","loading","target","currentPage","queryInput","lightbox","SimpleLightbox","options","onLoad","entries","entry","hits","error","observer","onFormSubmit","e","iziToast"],"mappings":"6vBAAe,SAASA,EAAaC,EAAK,CACxC,OAAOA,EACJ,IACCC,GACE;AAAA,uCAC+BA,EAAG,aAAa;AAAA;AAAA;AAAA,qBAGlCA,EAAG,YAAY;AAAA,qBACfA,EAAG,IAAI;AAAA;AAAA;AAAA;AAAA,sDAI0BA,EAAG,KAAK;AAAA,sDACRA,EAAG,KAAK;AAAA,yDACLA,EAAG,QAAQ;AAAA,0DACVA,EAAG,SAAS;AAAA;AAAA,cAGjE,EACA,KAAK,EAAE,CACZ,CCXwB,SAAAC,EAAkBC,EAAeC,EAAc,CAC/D,MAAAC,EAAS,IAAI,gBAAiB,CAClC,IAAK,qCACL,EAAGF,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,KAAMC,EAAK,SAAS,CAAA,CACrB,EAED,OAAO,MAAM,4BAA4BC,CAAM,EAAE,EAAE,KAAYC,GAAA,CACzD,GAAA,CAACA,EAAI,GACP,MAAM,IAAI,MAAMA,EAAI,OAAO,SAAU,CAAA,EAEvC,OAAOA,EAAI,MAAK,CACjB,CACH,CClBA,MAAMC,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,WAAW,EAEjD,IAAIC,EAAc,EACdC,EAAa,GAEjB,MAAMC,EAAW,IAAIC,EAAe,aAAc,CAChD,SAAU,GACV,aAAc,MACd,aAAc,GAChB,CAAC,EAIKC,EAAU,CACd,KAAM,KACN,WAAY,QACZ,UAAW,CACb,EAEMC,EAASC,GAAW,CACxBA,EAAQ,QAAQC,GAAS,CACnBA,EAAM,iBACRP,IACAT,EAAkBU,EAAYD,CAAW,EACtC,KAAK,CAAC,CAAE,KAAAQ,KAAW,CAClBV,EAAQ,UAAU,OAAO,WAAW,EACpCD,EAAQ,mBAAmB,YAAaT,EAAaoB,CAAI,CAAC,EAC1DN,EAAS,QAAO,CAC1B,CAAS,EACA,MAAMO,GAAS,CACd,QAAQ,IAAIA,CAAK,CAC3B,CAAS,EACA,QAAQ,IAAM,CACbX,EAAQ,UAAU,IAAI,WAAW,CAC3C,CAAS,EAET,CAAG,CACH,EAEMY,EAAW,IAAI,qBAAqBL,EAAQD,CAAO,EAIzDR,EAAK,iBAAiB,SAAUe,CAAY,EAE5C,SAASA,EAAaC,EAAG,CAIvB,GAHAA,EAAE,eAAc,EAChBX,EAAaW,EAAE,cAAc,SAAS,MAAM,MAExCX,IAAe,GAAI,CACrBY,EAAS,MAAM,CACb,QACE,uBACR,CAAK,EACD,MACD,CACDtB,EAAkBU,EAAYD,CAAW,EACtC,KAAK,CAAC,CAAE,KAAAQ,KAAW,CACdA,EAAK,SAAW,EAClBK,EAAS,MAAM,CACb,QACE,0EACZ,CAAS,GAEDf,EAAQ,UAAU,OAAO,WAAW,EACpCD,EAAQ,mBAAmB,YAAaT,EAAaoB,CAAI,CAAC,EAC1DE,EAAS,QAAQX,CAAM,EACvBG,EAAS,QAAO,EAExB,CAAK,EACA,MAAMO,GAAS,CACd,QAAQ,IAAIA,CAAK,CACvB,CAAK,EACA,QAAQ,IAAM,CACbX,EAAQ,UAAU,IAAI,WAAW,CACvC,CAAK,CACL"}